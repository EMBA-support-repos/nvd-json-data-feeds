{
  "id": "CVE-2023-5129",
  "sourceIdentifier": "cve-coordination@google.com",
  "published": "2023-09-25T21:15:16.667",
  "lastModified": "2023-09-27T15:19:41.593",
  "vulnStatus": "Modified",
  "descriptions": [
    {
      "lang": "en",
      "value": "With a specially crafted WebP lossless file, libwebp may write data out of bounds to the heap.\n\nThe ReadHuffmanCodes() function allocates the HuffmanCode buffer with a size that comes from an array of precomputed sizes: kTableSize. The color_cache_bits value defines which size to use.\n\nThe kTableSize array only takes into account sizes for 8-bit first-level table lookups but not second-level table lookups. libwebp allows codes that are up to 15-bit (MAX_ALLOWED_CODE_LENGTH). When BuildHuffmanTable() attempts to fill the second-level tables it may write data out-of-bounds. The OOB write to the undersized array happens in ReplicateValue.\n\n"
    },
    {
      "lang": "es",
      "value": "\"Con un archivo WebP sin p\u00e9rdidas especialmente manipulado, libwebp puede escribir datos fuera de los l\u00edmites del mont\u00f3n. La funci\u00f3n ReadHuffmanCodes() asigna el b\u00fafer HuffmanCode con un tama\u00f1o que proviene de una matriz de tama\u00f1os precalculados: \nkTableSize. \nEl valor color_cache_bits define qu\u00e9 tama\u00f1o usar.\n La matriz kTableSize solo tiene en cuenta los tama\u00f1os para b\u00fasquedas de tablas de primer nivel de 8 bits, pero no para b\u00fasquedas de tablas de segundo nivel.\n libwebp permite c\u00f3digos de hasta 15 bits (MAX_ALLOWED_CODE_LENGTH). \nCuando BuildHuffmanTable() intenta llenar las tablas de segundo nivel, puede escribir datos fuera de los l\u00edmites. La escritura OOB en la matriz de tama\u00f1o insuficiente ocurre en ReplicateValue.\""
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "cve-coordination@google.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-787"
        }
      ]
    },
    {
      "source": "cve-coordination@google.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:webmproject:libwebp:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.5.0",
              "versionEndExcluding": "1.3.2",
              "matchCriteriaId": "C4EDD159-D377-4070-861C-8D5E92E6C3B4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2023/09/26/1",
      "source": "cve-coordination@google.com"
    },
    {
      "url": "https://chromium.googlesource.com/webm/libwebp/+/2af26267cdfcb63a88e5c74a85927a12d6ca1d76",
      "source": "cve-coordination@google.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://chromium.googlesource.com/webm/libwebp/+/902bc9190331343b2017211debcec8d2ab87e17a",
      "source": "cve-coordination@google.com",
      "tags": [
        "Patch"
      ]
    }
  ]
}